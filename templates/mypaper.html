<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>壁影</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Girls">
  <link rel="icon" href="/static/images/hlm.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,shrink-to-fit=yes">
  <meta name="format-detection" content="telephone=no">
    <script src="https://shootest.jp/wp-content/themes/shootest_v4/js/viewport.js"></script>
  <link rel="icon" href="https://shootest.jp/wp-content/themes/shootest_v4/favicon.png">
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO plugin v18.6 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>壁影</title>
<link rel='stylesheet' id='wpcf7-redirect-script-frontend-css'  href='https://shootest.jp/wp-content/plugins/wpcf7-redirect/build/css/wpcf7-redirect-frontend.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='amazonjs-css'  href='https://shootest.jp/wp-content/plugins/amazonjs/css/amazonjs.css' type='text/css' media='all' />
<link rel='stylesheet' id='cf7cf-style-css'  href='https://shootest.jp/wp-content/plugins/cf7-conditional-fields/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='style-css'  href="{{ url_for('static', filename = 'style.css') }}" type='text/css' media='all' />
<link rel='stylesheet' id='common2-css'  href='https://shootest.jp/wp-content/themes/shootest_v4/lib/css/common.css' type='text/css' media='all' />
<link rel='stylesheet' id='fonts-css'  href='https://shootest.jp/wp-content/themes/shootest_v4/css/fonts.css' type='text/css' media='all' />
<link rel='stylesheet' id='boxer-css'  href='https://shootest.jp/wp-content/themes/shootest_v4/css/jquery.fs.boxer.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='modal-css'  href='https://shootest.jp/wp-content/themes/shootest_v4/css/jquery.modal.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='index-css'  href='https://shootest.jp/wp-content/themes/shootest_v4/lib/css/index.css' type='text/css' media='all' />
<script type='text/javascript' src='https://shootest.jp/wp-includes/js/jquery/jquery.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='https://shootest.jp/wp-includes/js/jquery/jquery-migrate.min.js' id='jquery-migrate-js'></script>

</head>

<div id="ibContainer" class="container-full">

      <div id="ibSlide">
        <div class="logout-btn">
            <!-- <button class="logout-btn" onclick="logout(this)">logout</button> -->
          </a>
        </div>
        <div class="slide-bg" style="background-image: url('../static/images/background.jpg')"></div>
      </div>
      <div id="ibSlideCont">
        <div class="ib-copy-inner">
          <h2>壁の影</h2>
          <p>艺术空间 无限美感</p>
        </div>

  </div>
</div>

  <h2 class="search-ttl">  </h2> 

  <div class="home-section-ttl">
    <h2 class="f-alp"><a href="{{ url_for('logout') }}">登出</a></h2>
  </div>
 
<div class="add-wallpaper" id="add-wallpaper" style="display:none;">

  <form method="post" action="/upload" enctype="multipart/form-data">
    <label  display: inline-block>添加壁纸</label>
    <div class="form-row">
      <label  display: inline-block>位置:</label>
       <input type="text" name="location" autocomplete="off" required>
    </div>
      <!-- <input class="btn" type="submit" name="submit" value="Add"> -->
      <div class="form-row">
          <label for="theme" display: inline-block>类型:</label>
          <input type="checkbox" name="theme" value="rw"> 人文
          <input type="checkbox" name="theme" value="zr" > 自然
          <input type="checkbox" name="theme" value="dm"> 动漫
          <input type="checkbox" name="theme" value="dw" > 动物
          <input type="checkbox" name="theme" value="art" > 艺术
      </div>
        <div>
          <label for="file">选择壁纸</label>
          <input type="file" name="file" id="file">
          <input type="hidden" name="username" value= "{{ username }}">
          <button type="submit">上传</button>

        </div>
    </form>
</div>

<div class="modify-wallpaper" id ="modify-wallpaper"  style="display:none;">
  <form method="post" action="/modify" enctype="multipart/form-data">
  <p> 修改壁纸</p>

    <div class="form-row">
      <label  display: inline-block>位置:</label>
       <input type="text" name="location" autocomplete="off" required>
    </div>
      <!-- <input class="btn" type="submit" name="submit" value="Add"> -->
      <div class="form-row">
          <label for="theme" display: inline-block>类型:</label>
          <input type="checkbox" name="theme" value="rw"> 人文
          <input type="checkbox" name="theme" value="zr" > 自然
          <input type="checkbox" name="theme" value="dm"> 动漫
          <input type="checkbox" name="theme" value="dw" > 动物
          <input type="checkbox" name="theme" value="art" > 艺术
      </div>
        <input type="hidden" name="username" value= "{{ username }}">

        <button type="submit">修改</button>
    </form>
</div>


<section id="pickup" class="contents">
  <div class="home-section-inner pb0">

    <div class="home-section-ttl">
      <h2 class="f-alp">作品集</h2>
      <p>发觉灵感</p>
    </div>
    <div class="home-pickup-container">      
        {% for paper in papers %}
            <article class="home-pickup-item hover-fade">
            <!-- <div id = "photo-wall"> -->
                <a href="https://shootest.jp/studio/s760/" class="tdn">
                    <div class="photo">
                      <img src = {{ url_for('static', filename= paper.name)}}  alt="wallpaper" class = 'image'>
                      <button class="delete-btn" onclick="deleteImage(this)">Delete</button>
                      <button class="modify-btn" onclick="modifyImage(this)">modify</button>
                    </div>
                    <div class="pickup-data">
                                    <div class="category-wrap">
                        <p class="studio-area"><i class="icon-pin"></i>
                        {{ paper.location }}                              </p>
                        <p class="studio-scene"><i class="icon-tag"></i>
                        {{ paper.uploader }}                               </p>
                    </div>
                    </div>
                </a>
            <!-- </div> -->

            </article>   
        {% endfor %}      
    </div>

  </div>
</section>


</div><!-- wrapper -->

<div class="concierge-wrapper"></div>

<footer>

<div class="go-top f-alp">PAGE TOP<i class="fa fa-angle-up"></i></div>

<div class="f-inner contents narrow">

</div><!-- f-inner -->

</footer>
<script type='text/javascript'>
  function deleteImage(btn) {
    // 获取包含图片和按钮的 <div> 元素
    var div = btn.parentNode;
    var imagediv = div.parentNode;
    // 阻止事件冒泡
    event.preventDefault();
    event.stopPropagation();
    console.log(div);
    console.log(btn);

    // 获取图片的 src 属性
    var src = div.querySelector('.image').getAttribute('src');
    console.log(src);
    // 发送 AJAX 请求到 Flask 后端
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/delete-image');
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            // 请求成功，从页面中删除该元素
            div.remove();
        }
    };
    xhr.send(JSON.stringify({ 'src': src }));
    // 从页面中删除该元素
    imagediv.remove();
}
</script>
<script type='text/javascript'>
  function modifyImage(btn) {
    // 获取包含图片和按钮的 <div> 元素
    var div = btn.parentNode;
    var imagediv = div.parentNode;
    // 阻止事件冒泡
    event.preventDefault();
    event.stopPropagation();
    var modifydiv = document.querySelector('.modify-wallpaper');
    modifydiv.style.display = 'block';
    var adddiv = document.querySelector('.add-wallpaper');
    adddiv.style.display = 'none';
    // 从页面中删除该元素
}
</script>

<script>

window.onload = function() {
  const element = document.getElementById('add-wallpaper');
  if (element) {
    element.style.display = 'block';
  }
}
</script>

</body>
</html>
